** English















*Description:*

- Find the atmospheric pressure for the surface of a constant field.

*Iteration method:*

- Column by column

*Dependencies:*

- A 3D field

*Result(s):*

- Pressure of the surface of a constant field, PXXX (hPa)

*Algorithm:*

#+begin_example
      For PDS ,          a 3D field.
      For PX (hPa),      the pressure of the model.
      For PXXX (hPa),    the pressure of the surface of a constant field.
      For FIELDCONSTANT, the desired values.

      Initialize to -1 all points in PXXX matrix
      Loop from the top or the bottom depending on --scanDirection value.
      If necessary, invert the matrix before the search (depending on --scanDirection).

      Loop on the columns of the matrix (i * j):
         Loop on the FIELDCONSTANT values (p): 
              Loop on the column levels (k), skipping the first and last levels:    
                  If a crossover is found between the field PDS and FIELDCONSTANT (between levels k and k-1):
                      Calculate PXXX (see formula below) 
                  End if
              End of loop on column levels (k)
          End of loop on FIELDCONSTANT values (p)
      End of loop on columns
#+end_example

#+begin_quote
  PXXX calculation:\\
  \\
     If (abs( PDS(k) - PDS(k - 1) ) <= 1E-5)\\
        \(\mathrm{ PXXX_{p} = PX_{k} }\)\\
     Else\\
        \(\mathrm{ AAA = 1 / ( PDS_{k} - PDS_{k - 1} ) }\)\\
        \(\mathrm{ WEIGHT = AAA * ( FIELDCONSTANT_{p} - PDS_{k - 1} )
  }\)\\
        \(\mathrm{ WEIGHTMINUS = AAA * ( PDS_{k} - FIELDCONSTANT_{p} )
  }\)\\
        \(\mathrm{ PXXX_{p} = PX_{k} * WEIGHT + PX_{k - 1} * WEIGHTMINUS
  }\)\\
     End if\\
#+end_quote

*Reference:*

- Does not apply

*Keywords:*

- MÉTÉO/WEATHER, isoplèthe/isopleth, pression/pressure

*Usage:*

*Call example:* 

#+begin_example
      ...
      spooki_run "[ReaderStd --input $SPOOKI_DIR/pluginsRelatedStuff/PressureOnIsopleth/testsFiles/inputFile.std] >>
                  [PressureOnIsopleth --fieldName TT --scanDirection DESCENDING --fieldConstant 20.0,25.0,30.0 --outputFieldName PXXX] >>
                  [WriterStd --output /tmp/$USER/outputFile.std]"
      ...
#+end_example

*Results validation:*

*Contacts:*

- Author : [[https://wiki.cmc.ec.gc.ca/wiki/User:Prudhommes][Simon
  Prud'Homme]]
- Coded by : [[https://wiki.cmc.ec.gc.ca/wiki/User:Prudhommes][Simon
  Prud'Homme]]
- Support : [[https://wiki.cmc.ec.gc.ca/wiki/CMDW][CMDW]] /
  [[https://wiki.cmc.ec.gc.ca/wiki/CMDS][CMDS]]

Reference to 


Unit tests



*Uses:*\\

*Used by:*\\



  

